<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <description>Generated by OzTrack ${baseUrl}/</description>
    <#assign animal=analysis.animals[0]/>
    <Style id="animal-${animal.id?c}">
      <#assign animalKmlColour="${animal.colour?substring(5,7)}${animal.colour?substring(3,5)}${animal.colour?substring(1,3)}"/>
      <LineStyle>
        <color>cc${animalKmlColour}</color>
        <width>4</width>
      </LineStyle>
    </Style>
    <Schema name="KalmanFilter" id="KalmanFilter">
      <SimpleField name="id" type="string"/>
      <#list analysis.analysisType.overallResultAttributeTypes as resultAttributeType>
      <SimpleField name="${resultAttributeType.identifier}" type="${resultAttributeType.dataType}"/>
      </#list>
    </Schema>
    <ExtendedData>
      <SchemaData schemaUrl="#KalmanFilter">
        <#list analysis.analysisType.overallResultAttributeTypes as resultAttributeType>
        <SimpleData name="${resultAttributeType.identifier}">${analysis.getResultAttributeValue(resultAttributeType.identifier)?c}</SimpleData>
        </#list>
      </SchemaData>
    </ExtendedData>
    <Placemark>
      <styleUrl>#animal-${animal.id?c}</styleUrl>
      <name>${animal.animalName}</name>
      <visibility>1</visibility>
      <LineString>
        <coordinates>
          <#list analysis.resultFeatures as resultFeature>
          ${resultFeature.geometry.x},${resultFeature.geometry.y}
          </#list>
        </coordinates>
      </LineString>
    </Placemark>
  </Document>
</kml>